"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const index_1 = require("./index");
// Mock environment
process.env.AWS_REGION = 'us-east-1';
process.env.S3_BUCKET_NAME = 'test-bucket';
// Mock event for Knock.app
const mockEvent = {
    body: JSON.stringify({
        companyName: 'Knock',
        domain: 'docs.knock.app',
        sessionId: 'local-test-session'
    })
};
async function runTest() {
    console.log('--- STARTING LOCAL VERIFICATION ---');
    try {
        const result = await (0, index_1.handler)(mockEvent);
        console.log('--- HANDER EXECUTION COMPLETE ---');
        console.log('Status Code:', result.statusCode);
        if (result.statusCode === 200) {
            const body = JSON.parse(result.body);
            console.log('Total Issues Found:', body.totalFound);
            // Check for proactive audits
            const audits = body.issues.filter((i) => i.id.startsWith('audit-'));
            console.log('Proactive Audits Found:', audits.length);
            audits.forEach((audit) => {
                console.log(`- ${audit.title} (${audit.category})`);
            });
            if (audits.length >= 3) {
                console.log('SUCCESS: Proactive audits were injected!');
            }
            else {
                console.log('FAILURE: Proactive audits missing.');
            }
        }
        else {
            console.log('Handler returned error:', result.body);
        }
    }
    catch (error) {
        console.error('Test execution failed:', error);
    }
}
runTest();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9jYWwtdmVyaWZ5LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsibG9jYWwtdmVyaWZ5LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQ0EsbUNBQWtDO0FBR2xDLG1CQUFtQjtBQUNuQixPQUFPLENBQUMsR0FBRyxDQUFDLFVBQVUsR0FBRyxXQUFXLENBQUM7QUFDckMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxjQUFjLEdBQUcsYUFBYSxDQUFDO0FBRTNDLDJCQUEyQjtBQUMzQixNQUFNLFNBQVMsR0FBeUI7SUFDcEMsSUFBSSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUM7UUFDakIsV0FBVyxFQUFFLE9BQU87UUFDcEIsTUFBTSxFQUFFLGdCQUFnQjtRQUN4QixTQUFTLEVBQUUsb0JBQW9CO0tBQ2xDLENBQUM7Q0FDRSxDQUFDO0FBRVQsS0FBSyxVQUFVLE9BQU87SUFDbEIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxxQ0FBcUMsQ0FBQyxDQUFDO0lBQ25ELElBQUk7UUFDQSxNQUFNLE1BQU0sR0FBRyxNQUFNLElBQUEsZUFBTyxFQUFDLFNBQVMsQ0FBQyxDQUFDO1FBRXhDLE9BQU8sQ0FBQyxHQUFHLENBQUMsbUNBQW1DLENBQUMsQ0FBQztRQUNqRCxPQUFPLENBQUMsR0FBRyxDQUFDLGNBQWMsRUFBRSxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUM7UUFFL0MsSUFBSSxNQUFNLENBQUMsVUFBVSxLQUFLLEdBQUcsRUFBRTtZQUMzQixNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUNyQyxPQUFPLENBQUMsR0FBRyxDQUFDLHFCQUFxQixFQUFFLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUVwRCw2QkFBNkI7WUFDN0IsTUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFNLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUM7WUFDekUsT0FBTyxDQUFDLEdBQUcsQ0FBQyx5QkFBeUIsRUFBRSxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUM7WUFFdEQsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLEtBQVUsRUFBRSxFQUFFO2dCQUMxQixPQUFPLENBQUMsR0FBRyxDQUFDLEtBQUssS0FBSyxDQUFDLEtBQUssS0FBSyxLQUFLLENBQUMsUUFBUSxHQUFHLENBQUMsQ0FBQztZQUN4RCxDQUFDLENBQUMsQ0FBQztZQUVILElBQUksTUFBTSxDQUFDLE1BQU0sSUFBSSxDQUFDLEVBQUU7Z0JBQ3BCLE9BQU8sQ0FBQyxHQUFHLENBQUMsMENBQTBDLENBQUMsQ0FBQzthQUMzRDtpQkFBTTtnQkFDSCxPQUFPLENBQUMsR0FBRyxDQUFDLG9DQUFvQyxDQUFDLENBQUM7YUFDckQ7U0FDSjthQUFNO1lBQ0gsT0FBTyxDQUFDLEdBQUcsQ0FBQyx5QkFBeUIsRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7U0FDdkQ7S0FDSjtJQUFDLE9BQU8sS0FBSyxFQUFFO1FBQ1osT0FBTyxDQUFDLEtBQUssQ0FBQyx3QkFBd0IsRUFBRSxLQUFLLENBQUMsQ0FBQztLQUNsRDtBQUNMLENBQUM7QUFFRCxPQUFPLEVBQUUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIlxuaW1wb3J0IHsgaGFuZGxlciB9IGZyb20gJy4vaW5kZXgnO1xuaW1wb3J0IHsgQVBJR2F0ZXdheVByb3h5RXZlbnQgfSBmcm9tICdhd3MtbGFtYmRhJztcblxuLy8gTW9jayBlbnZpcm9ubWVudFxucHJvY2Vzcy5lbnYuQVdTX1JFR0lPTiA9ICd1cy1lYXN0LTEnO1xucHJvY2Vzcy5lbnYuUzNfQlVDS0VUX05BTUUgPSAndGVzdC1idWNrZXQnO1xuXG4vLyBNb2NrIGV2ZW50IGZvciBLbm9jay5hcHBcbmNvbnN0IG1vY2tFdmVudDogQVBJR2F0ZXdheVByb3h5RXZlbnQgPSB7XG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBjb21wYW55TmFtZTogJ0tub2NrJyxcbiAgICAgICAgZG9tYWluOiAnZG9jcy5rbm9jay5hcHAnLFxuICAgICAgICBzZXNzaW9uSWQ6ICdsb2NhbC10ZXN0LXNlc3Npb24nXG4gICAgfSlcbn0gYXMgYW55O1xuXG5hc3luYyBmdW5jdGlvbiBydW5UZXN0KCkge1xuICAgIGNvbnNvbGUubG9nKCctLS0gU1RBUlRJTkcgTE9DQUwgVkVSSUZJQ0FUSU9OIC0tLScpO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGhhbmRsZXIobW9ja0V2ZW50KTtcblxuICAgICAgICBjb25zb2xlLmxvZygnLS0tIEhBTkRFUiBFWEVDVVRJT04gQ09NUExFVEUgLS0tJyk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdTdGF0dXMgQ29kZTonLCByZXN1bHQuc3RhdHVzQ29kZSk7XG5cbiAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXNDb2RlID09PSAyMDApIHtcbiAgICAgICAgICAgIGNvbnN0IGJvZHkgPSBKU09OLnBhcnNlKHJlc3VsdC5ib2R5KTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdUb3RhbCBJc3N1ZXMgRm91bmQ6JywgYm9keS50b3RhbEZvdW5kKTtcblxuICAgICAgICAgICAgLy8gQ2hlY2sgZm9yIHByb2FjdGl2ZSBhdWRpdHNcbiAgICAgICAgICAgIGNvbnN0IGF1ZGl0cyA9IGJvZHkuaXNzdWVzLmZpbHRlcigoaTogYW55KSA9PiBpLmlkLnN0YXJ0c1dpdGgoJ2F1ZGl0LScpKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdQcm9hY3RpdmUgQXVkaXRzIEZvdW5kOicsIGF1ZGl0cy5sZW5ndGgpO1xuXG4gICAgICAgICAgICBhdWRpdHMuZm9yRWFjaCgoYXVkaXQ6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGAtICR7YXVkaXQudGl0bGV9ICgke2F1ZGl0LmNhdGVnb3J5fSlgKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAoYXVkaXRzLmxlbmd0aCA+PSAzKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1NVQ0NFU1M6IFByb2FjdGl2ZSBhdWRpdHMgd2VyZSBpbmplY3RlZCEnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0ZBSUxVUkU6IFByb2FjdGl2ZSBhdWRpdHMgbWlzc2luZy4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdIYW5kbGVyIHJldHVybmVkIGVycm9yOicsIHJlc3VsdC5ib2R5KTtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1Rlc3QgZXhlY3V0aW9uIGZhaWxlZDonLCBlcnJvcik7XG4gICAgfVxufVxuXG5ydW5UZXN0KCk7XG4iXX0=